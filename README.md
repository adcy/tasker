# Тул для автоматического создания задач в TFS со страницы проработки на wiki
[Github](https://github.com/adcy/tasker)

Для заведения задач в тфс нужно выполнить команду: `tasker sync <WIKI_PAGE_ID>`
* `WIKI_PAGE_ID` - Это значение параметра `pageId` в ссылке вида: `https://wiki.infotecs.int/pages/viewpage.action?pageId=258876960`
* Все ключи команды можно узнать выполнив `tasker sync --help`

## Первоначальная настройка
Для хранения настроек используется файл `.tasker.yaml`, который нужно положить либо рядом с исполняемым файлом, либо в homе директорию.

### Обязательно нужно задать следующие ключи:
* `tfsAccessToken` - персональный токен досутпа к TFS
* `wikiAccessToken` - персональный токен доступа к Wiki

### Обязательные, но можно не менять, дефолт должен подойти:
* `tfsBaseAddress` - адрес TFS
* `wikiBaseAddress` - адрес Wiki
* `tfsDiscipline` - сабж

### Необязательные
Кроме команды синхронизации поддерживается еще некоторые вспомогательные команды, их описание можно узнать с помощью ключа `--help`. Для их использования нужно задать следующие ключи:
* `tfsProject` - проект, в котором создавать задачи
* `tfsTeam` - команда, в которой создавать задачи
* `tfsUserFilter` - имя пользователя, на которого вешать задачи при создании
* `tfsBugfixUserStoryNamePattern` - паттерн для поиска UserStory для создания задачи-багфикса
* `tfsCommonUserStoryNamePattern` - паттерн для поиска UserStory для создания простой задачи
* `tfsBugTitleTemplate` - шаблон имени бага для команды `bugfix`


# Правила оформления задач на wiki странице
* Задачи должны быть в таблице
* Непосредственно перед таблицей должен быть текст со словом "Задачи" (regexp `i/.*задач.*/`, h1-n или просто тектст не имеет значения)
* Таблица должна содержать как минимум 4 столбца
    * "Задача" - заголовок задачи
    * "Описание" - описание задачи, верстка сохраняется
    * "Оценка" - оценка задачи
    * "TFS" - пусто, сюда будет вставлен макрос с ссылкой на задачу в TFS после содания задачи.
* Имена столбцов должны быть в точности такие, как в списке выше
* Если в списке задач присутствуют строки-заголовки для деления таблицы на части (бекенд/фронтенд), то в колонке "TFS" нужно вставить какой-нибуть текст, например `n/a`, тогда такая строка будет пропущена. Либо не заполнять столбце "Оценка"
* Строки с пустым значением в столбце "Оценка пропускаются"

## FYI
* Поддерживается нескольцо таблиц на странице, можно выбирать какую таблицу рассматривать
* Если нужно пропустить таблицу, то можно вставить перед таблицей пустую строку, изменить заголовок и т.п.
* Все ключи команды можно узнать выполнив `tasker sync --help`

# Опциональные параметры
## Свой шаблон макроса TFS задач для команды `tasker sync` (т.е. в таблице проработки)
По умолчанию макрос задачи включает в себя только статус задачи и на кого она назначена. 
Если этой информации недостаточно, то можно указать путь к своему шаблону для макроса задачи. 
Указывается это в файле настроек параметром `syncCmdTfsTaskMacroPath: .tasker.tfs-task-macro.xml`, .tasker.tfs-task-macro.xml в данном случае шаблон макроса. 
Пример шаблона макроса также находится в репозитории (рядом с этим файлом).
Шаблон макроса и соответствующий параметр в конфиге являются необязательными, без ниих tasker будет использовать дефолтный шаблон макроса.
